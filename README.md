# Nantes Traffic Analysis Project

## Description

This project analyzes historical traffic data collected periodically from the Nantes Métropole open data portal. It processes raw snapshots, performs temporal and spatial analysis, and generates visualizations including static plots and an interactive heatmap to understand traffic flow, speed, and congestion patterns within Nantes.

## Features

*   **Data Processing:** Consolidates and cleans raw CSV traffic snapshots into an efficient Parquet format (`trafic_processing_master.py`).
*   **Coordinate Mapping:** Generates a master file mapping traffic sensor channel names to geographic coordinates.
*   **Temporal Analysis:** Analyzes traffic patterns based on the hour of the day, day of the week, and weekdays vs. weekends (`trafic_analysis_updated.py`).
*   **Spatial Analysis:** Identifies the most congested, fastest, and slowest streets based on average flow and speed (`trafic_spatial_analysis_updated.py`).
*   **Density Heatmap:** Generates a static density heatmap showing traffic flow concentration across the city (`trafic_heatmap_updated.py`).
*   **Interactive Heatmap:** Creates an interactive Folium map displaying traffic flow intensity (`trafic_heatmap_folium_updated.py`).
*   **Metrics Overview:** A utility script to display key metrics and information about the generated Parquet files (`view_parquet_metrics.py`).

## Data Source

The raw traffic snapshot data used for this analysis is collected periodically (e.g., every 30 minutes) from the Nantes Métropole open data source.

**The raw data collection and initial storage process is managed in a separate repository/process, which can be found here:**
➡️ **[Link to Data Source Repo/Process Description]** *(<- Replace this with the actual link or description)*

This analysis project assumes the raw CSV snapshots are available in a directory structure expected by `trafic_processing_master.py`. The master script then generates the necessary `cleaned_traffic_data.parquet` and `channel_coordinates.parquet` files used by the analysis scripts.

## Project Structure

```text
traffic analysis/
│
├── .conda/ # (Optional) Conda environment files if created here
├── results/ # Folder containing generated plots and maps
│ ├── Average Traffic Flow by Day of Week.png
│ ├── Average Traffic Flow per Hour Weekdays vs Weekends.png
│ ├── Average Traffic Flow per Hour.png
│ ├── Top 10 fastest streets.png
│ ├── Top 10 most congested streets.png
│ ├── Top 10 Slowest Streets (Potential Congestion Ares by Speed).png
│ ├── traffic flow heatmap nantes.png
│ └── traffic_heatmap_nantes_interactive.html
│
├── .gitignore # Specifies intentionally untracked files by Git
├── README.md # This file
├── requirements.txt # Python dependencies
├── trafic_analysis.py # Temporal analysis script
├── trafic_heatmap_folium.py # Interactive heatmap generation
├── trafic_heatmap.py # Static heatmap generation
├── trafic_processing_master.py # Master data processing and cleaning script
├── trafic_spatial_analysis.py # Spatial analysis script
└── view_parquet_metrics.py # Script to view Parquet file metrics
```
*(Note: The `.parquet` files generated by the processing script are typically large and often excluded via `.gitignore` in standard practice, but are required inputs for the analysis scripts).*

## Setup & Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git
    cd YOUR_REPO_NAME
    ```
2.  **Set up Environment (Recommended: Conda):**
    *   Ensure you have Anaconda or Miniconda installed.
    *   It's recommended to use the specific Conda environment where the dependencies were installed. Activate it using Anaconda Prompt or a configured terminal:
        ```bash
        # Replace path with the actual path to the environment used for this project
        conda activate "C:\Path\To\Your\Project\.conda"
        # Or activate by name if you created a named environment
        # conda activate your_env_name
        ```
3.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
    *(This requires `pandas`, `matplotlib`, `seaborn`, `folium`, `pyarrow`, `numpy`)*

## Usage

1.  **Obtain Raw Data:** Ensure the raw CSV snapshot files are available in the directory structure expected by `trafic_processing_master.py` (currently configured as `C:\Users\ASUS\Documents\Stage LS2N\nantes_traffic_archiver\dist\archive`). You may need to run the data fetching process from the source repository/process first.
2.  **Process Data:** Run the master processing script **first** to generate the required Parquet input files. Navigate to the `traffic analysis` directory in your activated environment terminal and run:
    ```bash
    python trafic_processing_master.py
    ```
    This will create/update `cleaned_traffic_data.parquet` and `channel_coordinates.parquet` in the configured output directory (currently `...\dist\`).
3.  **Run Analysis Scripts:** Execute the individual analysis scripts as needed:
    ```bash
    python trafic_analysis_updated.py
    python trafic_spatial_analysis_updated.py
    python trafic_heatmap_updated.py
    python trafic_heatmap_folium_updated.py
    ```
4.  **View Results:**
    *   Static plots (`.png` files) will be displayed during script execution and saved in the `results/` folder.
    *   The interactive heatmap is saved as `results/traffic_heatmap_nantes_interactive.html`. Open this file in your web browser to explore it.
5.  **View Parquet Metrics (Optional):**
    ```bash
    python view_parquet_metrics.py
    ```

## Results Overview

The `results/` folder contains visualizations generated by the analysis scripts.

**Temporal Analysis:**
![Average Flow per Hour](results/Average%20Traffic%20Flow%20per%20Hour.png)
![Average Flow Weekdays vs Weekends](results/Average%20Traffic%20Flow%20per%20Hour%20Weekdays%20vs%20Weekends.png)
![Average Flow by Day of Week](results/Average%20Traffic%20Flow%20by%20Day%20of%20Week.png)

**Spatial Analysis:**
![Top Congested Streets](results/Top%2010%20most%20congested%20streets.png)
![Top Fastest Streets](results/Top%2010%20fastest%20streets.png)
![Top Slowest Streets](results/Top%2010%20Slowest%20Streets%20(Potential%20Congestion%20Ares%20by%20Speed).png)

**Heatmaps:**
![Static Heatmap](results/traffic%20flow%20heatmap%20nantes.png)

*Interactive Heatmap:* Open the `results/traffic_heatmap_nantes_interactive.html` file locally in a web browser. *(Note: GitHub does not render interactive Folium maps directly in the repository view).*
